import org.gradle.internal.os.OperatingSystem

/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * User Manual available at https://docs.gradle.org/5.2.1/userguide/java_library_plugin.html
 */
plugins {
    // Apply the java-library plugin to add support for Java Library
    id 'java-library'
}

ext.FRC_YEAR = "2019"


repositories {
    // Use jcenter for resolving your dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
    mavenCentral()
    mavenLocal()
}


def getFrcToolsRoot ()
{
    if (OperatingSystem.current ().isWindows () )
    {
        String pubFolder = System.getenv("PUBLIC")
        if (pubFolder == null)
        {
            pubFolder = "C:\\Users\\Public"
        }

        return pubFolder + "/frc${FRC_YEAR}" 

    }
    else
    {
        return System.getProperty ("user.home") + "/frc${FRC_YEAR}"
    }
} 

def getDeployDest ()
{
    return System.getProperty ("user.home") + "/Shuffleboard/plugins"
}

def getShuffleboardJar ()
{
    return files(getFrcToolsRoot() + "/tools/shuffleboard.jar")
}


task deployWidget (type: Copy, group: "Shuffleboard Widget", description: "Copy the widget jar into the Shuffleboard plugin folder", dependsOn: "build") {
    from "build/libs"
    into getDeployDest ()
    include "*.jar"
}


jar {

    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}


dependencies {
    // This dependency is exported to consumers, that is to say found on their compile classpath.
    api 'org.apache.commons:commons-math3:3.6.1'

    // Installed FRC Shuffleboard jar.  Keep this so it knows how to resolve
    // the shuffleboard dependencies
    api getShuffleboardJar ()

    // Han Solo Gauge library dependency
    // YOU MAY REMOVE THIS IF YOU ARE NOT USING THE Han Solo GAUGE LIBRARY
    compile 'eu.hansolo:Medusa:8.3'

    // This dependency is used internally, and not exposed to consumers on their own compile classpath.
    implementation 'com.google.guava:guava:27.0.1-jre'

    // Use JUnit test framework
    testImplementation 'junit:junit:4.12'
}
